<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GLADIATOR • Empire Tracker</title>
<link rel="icon" type="image/webp" href="https://raw.githubusercontent.com/Kronborg1980/Gladiator-Collectables/main/logogla.webp">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700;900&family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
  :root { --a:#00f2ff; --d:#020408; --g:rgba(10,15,25,0.94); }
  body { margin:0; background:var(--d); color:white; font-family:'Inter',sans-serif; }
  .glass { background:var(--g); backdrop-filter:blur(30px); border:1px solid rgba(0,242,255,0.2); border-radius:16px; }
  .glow { text-shadow:0 0 40px var(--a); }
  .card-hover { transition:all .3s; }
  .card-hover:hover { transform:scale(1.05); box-shadow:0 0 30px rgba(0,242,255,0.4); }
</style>
</head>
<body class="min-h-screen p-6">

<div id="app" class="max-w-7xl mx-auto">

  <!-- Header -->
  <div class="glass p-8 mb-8 text-center">
    <img src="https://raw.githubusercontent.com/Kronborg1980/Gladiator-Collectables/main/logogla.webp" class="w-24 h-24 mx-auto mb-4">
    <h1 class="text-6xl font-bold" style="font-family:Cinzel;color:var(--a)" class="glow">GLADIATOR</h1>
    <p class="text-xl text-cyan-400 mt-2">Empire Tracker • {{cards.length}} cards • ${{totalValue}}</p>
  </div>

  <!-- 3-Step Card Search -->
  <div class="glass p-8 mb-8">
    <h2 class="text-3xl font-bold text-[var(--a)] mb-8 text-center">Add Card to Empire</h2>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">

      <!-- Step 1: Era -->
      <div>
        <label class="block text-sm uppercase text-gray-400 mb-2">1. Era</label>
        <select v-model="selectedEra" @change="selectedSet=''; cardsInSet=[]" class="w-full p-4 rounded-lg bg-white/10 border border-white/20 focus:border-[var(--a)] outline-none">
          <option value="">Choose Era</option>
          <option v-for="era in eras" :value="era">{{era}}</option>
        </select>
      </div>

      <!-- Step 2: Set -->
      <div>
        <label class="block text-sm uppercase text-gray-400 mb-2">2. Set</label>
        <select v-model="selectedSet" :disabled="!selectedEra" @change="loadCardsInSet" class="w-full p-4 rounded-lg bg-white/10 border border-white/20 focus:border-[var(--a)] outline-none">
          <option value="">Choose Set</option>
          <option v-for="set in setsInEra" :value="set.id">{{set.name}} ({{set.printedTotal}} cards)</option>
        </select>
      </div>

      <!-- Step 3: Card -->
      <div>
        <label class="block text-sm uppercase text-gray-400 mb-2">3. Card</label>
        <select v-model="selectedCard" :disabled="!selectedSet" class="w-full p-4 rounded-lg bg-white/10 border border-white/20 focus:border-[var(--a)] outline-none">
          <option value="">Choose Card</option>
          <option v-for="card in cardsInSet" :value="card">
            {{card.name}} #{{card.number}} — ${{cardPrice(card)}}
          </option>
        </select>
      </div>
    </div>

    <div class="text-center mt-8">
      <button @click="addCardToCollection" :disabled="!selectedCard" class="bg-[var(--a)] hover:bg-white text-black font-bold text-xl px-12 py-5 rounded-xl disabled:opacity-50 disabled:cursor-not-allowed transition shadow-lg shadow-[var(--a)]/30">
        CONQUER THIS CARD
      </button>
    </div>
  </div>

  <!-- Collection Grid -->
  <div class="glass p-8">
    <h2 class="text-3xl font-bold text-[var(--a)] mb-6">Your Empire ({{cards.length}} cards)</h2>
    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-6">
      <div v-for="c in cards" :key="c.id" class="glass rounded-xl overflow-hidden card-hover cursor-pointer" @click="alert(c.name + ' — $' + c.market)">
        <img :src="c.image" class="w-full aspect-[0.7] object-cover">
        <div class="p-3">
          <p class="font-bold text-sm truncate">{{c.name}}</p>
          <p class="text-xs text-gray-400">{{c.set}}</p>
          <p class="text-[var(--a)] font-bold text-lg">${{c.market}}</p>
        </div>
      </div>
    </div>
  </div>

</div>

<script>
const { createApp, ref, computed, onMounted } = Vue;

createApp({
  data() { return {
    eras: [],
    sets: [],
    selectedEra: '',
    selectedSet: '',
    selectedCard: null,
    cardsInSet: [],
    cards: JSON.parse(localStorage.getItem('gladiator_cards') || '[]')
  }},
  computed: {
    setsInEra() { return this.selectedEra ? this.sets.filter(s => s.series === this.selectedEra) : [] },
    totalValue() { return this.cards.reduce((s,c) => s + c.market, 0).toFixed(0) }
  },
  methods: {
    async loadAllData() {
      const res = await fetch('https://api.pokemontcg.io/v2/sets?orderBy=-releaseDate', {
        headers: { 'X-Api-Key': '7191ffb5-91d7-4fb7-bc30-94f1b854ee6e' }
      });
      const data = await res.json();
      this.sets = data.data;
      this.eras = [...new Set(data.data.map(s => s.series))].sort();
    },
    async loadCardsInSet() {
      if (!this.selectedSet) return;
      const res = await fetch(`https://api.pokemontcg.io/v2/cards?q=set.id:${this.selectedSet}`, {
        headers: { 'X-Api-Key': '7191ffb5-91d7-4fb7-bc30-94f1b854ee6e' }
      });
      const data = await res.json();
      this.cardsInSet = data.data;
    },
    cardPrice(c) {
      const p = c.tcgplayer?.prices;
      return p?.holofoil?.market || p?.reverseHolofoil?.market || p?.normal?.market || '??';
    },
    addCardToCollection() {
      if (!this.selectedCard) return;
      const market = this.cardPrice(this.selectedCard);
      const newCard = {
        id: this.selectedCard.id,
        name: this.selectedCard.name,
        set: this.selectedCard.set.name,
        image: this.selectedCard.images.small,
        market: parseFloat(market) || 50
      };
      this.cards.unshift(newCard);
      localStorage.setItem('gladiator_cards', JSON.stringify(this.cards));
      // Reset
      this.selectedCard = null;
      this.selectedSet = '';
      this.cardsInSet = [];
    }
  },
  mounted() {
    this.loadAllData();
  }
}).mount('#app');
</script>
</body>
</html>

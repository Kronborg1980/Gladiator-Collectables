<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>Gladiator Collectibles - Grading Tracker</title>        <script src="https://cdn.tailwindcss.com"></script>        <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>        <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">    <style>        /* GLADIATOR THEME */        :root {            --bg-color: #050505;            --gold-primary: #D4AF37;            --text-main: #e2e8f0;        }        body {             font-family: 'Lato', sans-serif;             background-color: var(--bg-color);            background-image: radial-gradient(circle at top center, #1a1a1a 0%, #000000 70%);            color: var(--text-main);        }        h1, h2, h3, .brand-font { font-family: 'Cinzel', serif; }        .gladiator-panel {            background: rgba(18, 18, 18, 0.95);            border: 1px solid rgba(212, 175, 55, 0.3);            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.8);        }        .text-gold { color: var(--gold-primary); }        .text-gold-gradient {            background: linear-gradient(to right, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);            -webkit-background-clip: text;            background-clip: text;            color: transparent;        }        input, select, textarea {            background-color: #0a0a0a !important;            border: 1px solid #333 !important;            color: #fff !important;        }        input:focus, select:focus, textarea:focus {            border-color: var(--gold-primary) !important;            box-shadow: 0 0 5px rgba(212, 175, 55, 0.5);            outline: none;        }        .card-img-wrapper {            position: relative;            padding-bottom: 139%;             overflow: hidden;            background: #1a1a1a;            border-radius: 6px;        }        .card-img-wrapper img {            position: absolute;            top: 0; left: 0; width: 100%; height: 100%;            object-fit: cover;        }    </style></head><body class="min-h-screen"><div id="app" class="p-4 md:p-8 max-w-[1800px] mx-auto">        <div class="flex flex-col md:flex-row justify-between items-end mb-8 border-b border-[#333] pb-6">        <div>            <h1 class="text-3xl md:text-5xl font-bold text-gold-gradient mb-2 uppercase tracking-wider">                <i class="fa-solid fa-helmet-safety mr-3"></i>Gladiator Collectibles            </h1>            <p class="text-slate-400 text-sm tracking-widest uppercase ml-1">Grading Profit Calculator</p>        </div>        <div class="flex gap-4 mt-6 md:mt-0">            <div class="text-right px-6 border-r border-[#333]">                <div class="text-[10px] text-slate-500 uppercase tracking-wider">Inventory</div>                <div class="text-2xl font-bold text-white">{{ cards.length }} <span class="text-sm text-slate-600 font-normal">Cards</span></div>            </div>            <div class="text-right pl-6">                <div class="text-[10px] text-slate-500 uppercase tracking-wider">Potential Profit</div>                <div class="text-2xl font-bold" :class="totalProfit >= 0 ? 'text-[#D4AF37]' : 'text-red-500'">                    ${{ formatNumber(totalProfit) }}                </div>            </div>        </div>    </div>    <div class="flex flex-wrap gap-4 mb-6 justify-between items-center">        <div class="relative group">            <i class="fa-solid fa-search absolute left-3 top-3 text-slate-600 group-focus-within:text-[#D4AF37] transition"></i>            <input type="text" v-model="inventorySearch" placeholder="SEARCH INVENTORY..."                 class="pl-10 pr-4 py-2 w-64 md:w-80 rounded-sm text-xs tracking-wider uppercase focus:outline-none transition">        </div>        <div class="flex gap-2">            <button @click="exportToExcel" class="bg-[#1a1a1a] hover:bg-[#333] border border-[#333] text-green-500 px-4 py-2 rounded-sm text-xs font-bold uppercase tracking-widest transition flex items-center gap-2">                <i class="fa-solid fa-file-excel"></i> Backup to Excel            </button>                        <button @click="openModal" class="bg-[#D4AF37] hover:bg-[#b39028] text-black px-6 py-2 rounded-sm font-bold tracking-wider transition uppercase flex items-center gap-2 ml-2 shadow-[0_0_10px_rgba(212,175,55,0.2)]">                <i class="fa-solid fa-bolt"></i> Add Card            </button>        </div>    </div>    <div class="gladiator-panel rounded-lg overflow-hidden">        <div v-if="cards.length === 0" class="p-12 text-center text-slate-500">            <i class="fa-solid fa-magnifying-glass-chart text-6xl mb-4 text-[#333]"></i>            <h3 class="text-xl font-bold text-slate-400 mb-2 brand-font">Inventory Empty</h3>            <p class="text-sm mb-6">Use the "Add Card" button to search the database.</p>        </div>        <div v-else class="overflow-x-auto">            <table class="w-full text-left border-collapse">                <thead>                    <tr class="bg-black text-[#D4AF37] text-[10px] uppercase tracking-widest border-b border-[#D4AF37]/20">                        <th class="p-4">Card Info</th>                        <th class="p-4 text-right">Raw $</th>                        <th class="p-4 text-center">Exp. Grade</th>                        <th class="p-4 text-right text-slate-500">PSA 10</th>                        <th class="p-4 text-right text-white">Profit</th>                        <th class="p-4 text-center">Action</th>                        <th class="p-4"></th>                    </tr>                </thead>                <tbody class="text-sm divide-y divide-[#333]">                    <tr v-for="(card, index) in filteredCards" :key="index" class="hover:bg-[#1a1a1a] transition group">                        <td class="p-4">                            <div class="flex items-center gap-3">                                <div class="w-10 h-14 bg-[#111] rounded overflow-hidden border border-[#333] shrink-0">                                    <img v-if="card.image" :src="card.image" class="w-full h-full object-cover">                                    <div v-else class="w-full h-full flex items-center justify-center text-slate-700 text-xs">                                        No IMG                                    </div>                                </div>                                <div>                                    <div class="font-bold text-slate-200">{{ card.name }}</div>                                    <div class="text-[10px] text-slate-500 uppercase">{{ card.set }}</div>                                </div>                            </div>                        </td>                        <td class="p-4 text-right text-slate-400 font-mono">${{ card.raw }}</td>                        <td class="p-4 text-center">                            <select v-model="card.preGrade" @change="saveData" class="bg-black border border-[#333] text-[#D4AF37] text-xs font-bold py-1 px-2 rounded-sm text-center cursor-pointer">                                <option value="10">PSA 10</option>                                <option value="9">PSA 9</option>                                <option value="8">PSA 8</option>                            </select>                        </td>                        <td class="p-4 text-right text-xs text-slate-600 font-mono">${{ card.psa10 }}</td>                        <td class="p-4 text-right font-mono font-bold text-lg">                            <span :class="calculateProfit(card) > 0 ? 'text-[#D4AF37]' : 'text-[#8a1c1c]'">                                {{ calculateProfit(card) >= 0 ? '+' : '' }}${{ formatNumber(calculateProfit(card)) }}                            </span>                        </td>                         <td class="p-4 text-center">                             <select v-model="card.status" @change="saveData" class="bg-transparent text-xs text-slate-400 border-none focus:ring-0 cursor-pointer text-center">                                <option value="Inventory">Inventory</option>                                <option value="Grading">Sent</option>                                <option value="Sold">Sold</option>                            </select>                        </td>                        <td class="p-4 text-right">                            <button @click="deleteCard(index)" class="text-slate-700 hover:text-[#8a1c1c] transition">                                <i class="fa-solid fa-times"></i>                            </button>                        </td>                    </tr>                </tbody>            </table>        </div>    </div>    <div v-if="showModal" class="fixed inset-0 bg-black/95 backdrop-blur-sm flex items-center justify-center z-50 p-4">        <div class="gladiator-panel rounded-lg w-full max-w-5xl h-[90vh] flex flex-col relative overflow-hidden">                        <div class="p-6 border-b border-[#333] bg-[#111] flex justify-between items-center shrink-0">                <h2 class="text-2xl text-[#D4AF37] brand-font uppercase">Add Gladiator</h2>                <div class="flex items-center gap-4">                    <button @click="enableManualMode" class="text-xs uppercase tracking-widest text-slate-500 hover:text-[#D4AF37] underline">                        Or Enter Manually                    </button>                    <button @click="showModal = false" class="text-slate-500 hover:text-white"><i class="fa-solid fa-times text-xl"></i></button>                </div>            </div>                        <div v-if="!manualMode && !selectedApiCard" class="p-6 bg-[#0a0a0a] shrink-0 border-b border-[#333]">                <div class="relative">                    <input                         v-model="apiSearchQuery"                         @keyup.enter="triggerSearch"                        type="text"                         class="w-full p-4 pl-12 rounded-sm text-lg font-mono text-[#D4AF37] placeholder-slate-700 focus:ring-1 ring-[#D4AF37]"                         placeholder="Type Pokemon Name (e.g. Charizard 151)..."                    >                    <div class="absolute left-4 top-1/2 -translate-y-1/2 text-slate-500">                        <i v-if="isSearching" class="fa-solid fa-circle-notch fa-spin text-[#D4AF37]"></i>                        <i v-else class="fa-solid fa-search"></i>                    </div>                </div>                <div v-if="searchError" class="mt-2 text-red-400 text-xs font-mono">                    <i class="fa-solid fa-triangle-exclamation mr-1"></i> {{ searchError }}                </div>            </div>            <div class="flex-1 overflow-y-auto bg-[#050505] relative p-6">                                <div v-if="manualMode || selectedApiCard" class="animate-in fade-in slide-in-from-bottom-5 duration-300 max-w-2xl mx-auto">                    <button @click="resetSearch" class="mb-6 text-slate-500 hover:text-white text-xs uppercase tracking-widest flex items-center gap-2">                        <i class="fa-solid fa-arrow-left"></i> Back to Search                    </button>                                        <div class="space-y-6">                         <div v-if="draftCard.image" class="w-32 mx-auto">                            <img :src="draftCard.image" class="rounded border border-[#333]">                        </div>                        <div>                            <label class="text-[10px] uppercase tracking-widest text-slate-500">Card Name</label>                            <input v-model="draftCard.name" type="text" class="w-full p-3 rounded-sm mt-1 text-lg font-bold">                        </div>                        <div class="grid grid-cols-2 gap-4">                            <div>                                <label class="text-[10px] uppercase tracking-widest text-slate-500">Raw Price</label>                                <input v-model.number="draftCard.raw" type="number" class="w-full p-3 rounded-sm mt-1 font-mono text-[#D4AF37]">                            </div>                            <div>                                <label class="text-[10px] uppercase tracking-widest text-slate-500">Grading Cost</label>                                <input v-model.number="draftCard.gradingPrice" type="number" class="w-full p-3 rounded-sm mt-1 font-mono">                            </div>                        </div>                        <div class="bg-[#111] p-4 rounded border border-[#333]">                            <div class="grid grid-cols-3 gap-4">                                <div>                                    <label class="text-[10px] text-slate-500 block text-center mb-1">PSA 10</label>                                    <input v-model.number="draftCard.psa10" type="number" class="w-full p-2 text-center font-mono text-green-500 bg-black">                                </div>                                <div>                                    <label class="text-[10px] text-slate-500 block text-center mb-1">PSA 9</label>                                    <input v-model.number="draftCard.psa9" type="number" class="w-full p-2 text-center font-mono text-yellow-500 bg-black">                                </div>                                <div>                                    <label class="text-[10px] text-slate-500 block text-center mb-1">PSA 8</label>                                    <input v-model.number="draftCard.psa8" type="number" class="w-full p-2 text-center font-mono text-red-500 bg-black">                                </div>                            </div>                        </div>                        <button @click="addToInventory" class="w-full bg-[#D4AF37] hover:bg-white hover:text-black text-black px-8 py-4 font-bold uppercase tracking-widest rounded-sm transition shadow-[0_0_20px_rgba(212,175,55,0.3)]">                            Confirm & Add                        </button>                    </div>                </div>                <div v-else>                    <div v-if="apiResults.length > 0" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4">                        <div v-for="card in apiResults" :key="card.id"                             @click="selectCard(card)"                            class="group cursor-pointer bg-[#111] border border-[#333] hover:border-[#D4AF37] rounded-lg p-3 transition hover:-translate-y-1 relative">                            <div class="card-img-wrapper mb-3 border border-black">                                <img :src="card.images.small" loading="lazy">                            </div>                            <h4 class="font-bold text-xs text-slate-300 truncate group-hover:text-white">{{ card.name }}</h4>                            <div class="flex justify-between items-center mt-1">                                <span class="text-[9px] text-slate-500 uppercase truncate w-20">{{ card.set.name }}</span>                                <span v-if="getCardPrice(card) > 0" class="text-[#D4AF37] font-mono font-bold text-xs">                                    ${{ formatNumber(getCardPrice(card)) }}                                </span>                            </div>                        </div>                    </div>                                        <div v-else-if="!isSearching" class="text-center py-20 text-slate-600">                        <i class="fa-solid fa-dragon text-6xl mb-4 opacity-20"></i>                        <p class="text-sm">Type a name above to search.</p>                        <button @click="enableManualMode" class="mt-4 text-[#D4AF37] hover:underline text-xs uppercase tracking-widest">                            Can't find it? Enter Manually                        </button>                    </div>                </div>            </div>        </div>    </div></div><script>    const { createApp } = Vue;    createApp({        data() {            return {                inventorySearch: '',                apiSearchQuery: '',                isSearching: false,                searchError: '',                searchTimeout: null,                showModal: false,                manualMode: false,                apiResults: [],                selectedApiCard: null,                                draftCard: {                    name: '', raw: 0, gradingPrice: 20, preGrade: 10, psa10: 0, psa9: 0, psa8: 0,                     image: '', set: '', status: 'Inventory'                },                cards: []            }        },        mounted() {            const savedData = localStorage.getItem('gladiator_cards_v7');            if (savedData) this.cards = JSON.parse(savedData);        },        watch: {            apiSearchQuery(newVal) {                if(this.searchTimeout) clearTimeout(this.searchTimeout);                this.searchError = '';                                 if(newVal.length < 3) return;                this.isSearching = true;                this.searchTimeout = setTimeout(() => {                    this.fetchApiData(newVal);                }, 700);             }        },        computed: {            filteredCards() {                if(!this.inventorySearch) return this.cards;                return this.cards.filter(c => c.name.toLowerCase().includes(this.inventorySearch.toLowerCase()));            },            totalProfit() {                return this.cards.reduce((sum, card) => sum + this.calculateProfit(card), 0);            }        },        methods: {            formatNumber(num) { return (num || 0).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }); },                        async fetchApiData(query) {                this.apiResults = [];                this.searchError = '';                try {                    const safeQuery = query.trim().replace(/"/g, '');                     const url = `https://api.pokemontcg.io/v2/cards?q=name:"*${safeQuery}*"&orderBy=-set.releaseDate&pageSize=20`;                                        const res = await fetch(url);                                        if (!res.ok) throw new Error(`API Error: ${res.status}`);                    const data = await res.json();                    if(data.data && data.data.length > 0) {                        this.apiResults = data.data;                    } else {                        this.searchError = "No Gladiators found.";                    }                } catch(e) {                    this.searchError = "Connection Error or Not Found.";                } finally {                    this.isSearching = false;                }            },            getCardPrice(card) {                if(card.tcgplayer && card.tcgplayer.prices) {                    const prices = card.tcgplayer.prices;                    if(prices.holofoil) return prices.holofoil.market || prices.holofoil.mid;                    if(prices.normal) return prices.normal.market || prices.normal.mid;                    if(prices.reverseHolofoil) return prices.reverseHolofoil.market;                    if(prices['1stEditionHolofoil']) return prices['1stEditionHolofoil'].market;                }                return 0;            },            selectCard(apiCard) {                this.selectedApiCard = apiCard;                const rawPrice = parseFloat(this.getCardPrice(apiCard).toFixed(2));                this.draftCard = {                    name: apiCard.name,                    raw: rawPrice,                    gradingPrice: 20,                    preGrade: 10,                    psa10: parseFloat((rawPrice * 3.2).toFixed(2)),                    psa9: parseFloat((rawPrice * 1.1).toFixed(2)),                    psa8: parseFloat((rawPrice * 0.8).toFixed(2)),                    image: apiCard.images.small,                    set: apiCard.set.name,                    status: 'Inventory'                };            },            openModal() {                 this.showModal = true;                 this.resetSearch();             },            enableManualMode() {                this.manualMode = true;                this.selectedApiCard = null;                this.draftCard = { name: '', raw: 0, gradingPrice: 20, preGrade: 10, psa10: 0, psa9: 0, psa8: 0, status: 'Inventory' };            },            resetSearch() {                this.selectedApiCard = null;                this.manualMode = false;                this.apiResults = [];                this.apiSearchQuery = '';            },            addToInventory() {                this.cards.push({...this.draftCard});                this.saveData();                this.showModal = false;            },            deleteCard(index) {                if(confirm('Dismiss this gladiator?')) {                    this.cards.splice(index, 1);                    this.saveData();                }            },            saveData() { localStorage.setItem('gladiator_cards_v7', JSON.stringify(this.cards)); },                        calculateProfit(card) {                let val = 0;                if(card.preGrade == 10) val = card.psa10;                else if(card.preGrade == 9) val = card.psa9;                else if(card.preGrade == 8) val = card.psa8;                return (val || 0) - ((card.raw || 0) + (card.gradingPrice || 0));            },                        // EXCEL EXPORT FUNCTION            exportToExcel() {                // 1. Prepare Data for Excel                const dataToExport = this.cards.map(c => ({                    Name: c.name,                    Set: c.set || 'N/A',                    Raw_Price: c.raw,                    Grading_Cost: c.gradingPrice,                    Target_Grade: c.preGrade,                    PSA_10_Value: c.psa10,                    PSA_9_Value: c.psa9,                    Predicted_Profit: this.calculateProfit(c),                    Status: c.status                }));                // 2. Create Workbook using SheetJS                const ws = XLSX.utils.json_to_sheet(dataToExport);                const wb = XLSX.utils.book_new();                XLSX.utils.book_append_sheet(wb, ws, "Gladiator Inventory");                // 3. Save File                XLSX.writeFile(wb, "Gladiator_Backup.xlsx");            }        }    }).mount('#app');</script></body></html>